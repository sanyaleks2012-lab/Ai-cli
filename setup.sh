#!/data/data/com.termux/files/usr/bin/bash

# --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
REPO_ZIP_URL="https://github.com/sanyaleks2012-lab/Ai-cli/archive/refs/heads/main.zip"
WORKING_DIR="gemini-cli-assistant"
ZIP_FILE="repo.zip"
# –ò–º—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ—Å–ª–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ Ai-cli-main/
UNPACK_SUBDIR="Ai-cli-main" 

echo "==========================================="
echo "  üöÄ –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ Gemini CLI-–ü–æ–º–æ—â–Ω–∏–∫–∞"
echo "==========================================="

# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–≤
# –í–∫–ª—é—á–∞–µ—Ç: Python, Git, Wget, Unzip, eSpeak, Rust, CMake, Make, Clang
echo -e "\n[1/4] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Termux-–ø–∞–∫–µ—Ç–æ–≤ (Python, Rust, CMake, Make, TTS)..."
pkg update -y
pkg install python git wget unzip espeak clang rust cmake make -y

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
echo "–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ $WORKING_DIR..."
if [ -d "$WORKING_DIR" ]; then
    echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è $WORKING_DIR —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é..."
    rm -rf "$WORKING_DIR"
fi
mkdir "$WORKING_DIR"
cd "$WORKING_DIR"

# 3. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞
echo -e "\n[2/4] –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å GitHub..."
wget -O "$ZIP_FILE" "$REPO_ZIP_URL"

echo "–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤..."
unzip -q "$ZIP_FILE"
rm "$ZIP_FILE"

# –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –æ—Å–Ω–æ–≤–Ω—É—é
echo "–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é..."
if [ -d "$UNPACK_SUBDIR" ]; then
    mv "$UNPACK_SUBDIR"/* .
    rm -r "$UNPACK_SUBDIR"
else
    echo -e "\033[31;1m‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é $UNPACK_SUBDIR. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∞—Ä—Ö–∏–≤–∞.\033[0m"
    exit 1
fi

# 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python-–ø–∞–∫–µ—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞ uv
echo -e "\n[3/4] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤ uv..."
pip install uv

# 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –ø–æ–º–æ—â—å—é uv
# –í–∫–ª—é—á–∞–µ—Ç pydantic, requests, dotenv, colorama, pyttsx3
echo -e "\n[4/4] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (requests, dotenv, pydantic –∏ –¥—Ä.) —Å –ø–æ–º–æ—â—å—é uv..."
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ —É–∫–∞–∑–∞–Ω—ã –≤—Å–µ –≤–∞—à–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏!
uv pip install requests python-dotenv colorama pyttsx3 pydantic

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è .env
echo -e "\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ .env..."
if [ ! -f ".env" ]; then
    echo -e "\033[31;1m‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –§–∞–π–ª .env —Å –≤–∞—à–∏–º –∫–ª—é—á–æ–º API –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!\033[0m"
    echo "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ .env –≤ –∞—Ä—Ö–∏–≤ GitHub."
    exit 1
fi

# --- –§–ò–ù–ê–õ–¨–ù–´–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò ---
echo -e "\n==========================================="
echo -e "\033[32;1m‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\033[0m"
echo "–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–º–æ—â–Ω–∏–∫–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "1. \033[31;1m–í–∫–ª—é—á–∏—Ç–µ VPN/–ü—Ä–æ–∫—Å–∏\033[0m (–µ—Å–ª–∏ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –†–æ—Å—Å–∏–∏)."
echo "2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:"
echo -e "\n\033[36;1mpython cli_assistant.py\033[0m"
echo "==========================================="